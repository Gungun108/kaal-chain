<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç KAAL EXPLORER</title>
    <style>
        :root {
            --kaal: #ff4500;
            --bg: #0f0f0f;
            --card: #1a1a1a;
            --text: #ffffff;
        }

        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
        }

        /* Stats Cards ka design */
        .stats-row {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .stat-card {
            background: var(--card);
            padding: 20px;
            border-radius: 15px;
            flex: 1;
            min-width: 200px;
            border: 1px solid #333;
            text-align: center;
        }

        .stat-card h2 {
            color: var(--kaal);
            margin: 0;
            font-size: 28px;
        }

        /* Ledger Table ka design */
        .table-container {
            background: var(--card);
            border-radius: 15px;
            padding: 10px;
            overflow-x: auto;
            border: 1px solid #333;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        th {
            text-align: left;
            padding: 12px;
            border-bottom: 2px solid #333;
            color: var(--kaal);
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #222;
            font-size: 13px;
        }

        .hash-text {
            color: #00ff00;
            font-family: monospace;
            font-size: 11px;
        }
    </style>
</head>

<body>

    <h1 style="text-align:center; color:var(--kaal);">üîç KAAL CHAIN EXPLORER</h1>

    <div class="stats-row">
        <div class="table-container" style="margin-bottom: 20px;">
    <input type="text" id="searchInput" onkeyup="searchLedger()" placeholder="Search by Address, Hash, or Block Index..." 
           style="width:95%; padding:12px; border-radius:10px; border:1px solid #333; background:#222; color:white;">
</div>
        <div class="stat-card">
            <p>Total Blocks</p>
            <h2 id="totalBlocks">0</h2>
        </div>
        <div class="stat-card">
            <p>Total KAAL Supply</p>
            <h2 id="totalSupply">0.00</h2>
        </div>
        <div class="stat-card">
            <p>Network Status</p>
            <h2 style="color: #00ff00;">LIVE</h2>
        </div>
    </div>

    <div class="table-container">
        <h3>Recent Blocks</h3>
        <table>
            <thead>
                <tr>
                    <th>Index</th>
                    <th>Timestamp</th>
                    <th>Transactions</th>
                    <th>Hash</th>
                </tr>
            </thead>
            <tbody id="blockTable">
            </tbody>
        </table>
    </div>

    <script>
        async function updateExplorer() {
            try {
                // Server se poori chain aur stats mangwana
                const res = await fetch('/get_stats');
                const data = await res.json();

                // Stats update karna
                document.getElementById('totalBlocks').innerText = data.blocks;
                document.getElementById('totalSupply').innerText = data.total_supply.toFixed(2) + " KAAL";

                // Table mein blocks dhalna
                let html = '';
                data.chain.forEach(block => {
                    html += `
                        <tr>
                            <td><b>#${block.index}</b></td>
                            <td>${new Date(block.timestamp * 1000).toLocaleString()}</td>
                            <td>${block.transactions.length} Tx</td>
                            <td class="hash-text">${block.hash.substring(0, 30)}...</td>
                        </tr>
                    `;
                });
                document.getElementById('blockTable').innerHTML = html;
            } catch (e) {
                console.log("Explorer update fail...");
            }
        }

        // Shuruat mein load karna aur har 5 second mein refresh karna
        updateExplorer();
        setInterval(updateExplorer, 5000);

        function searchLedger() {
    let input = document.getElementById("searchInput").value.toLowerCase();
    let table = document.getElementById("blockTable");
    let rows = table.getElementsByTagName("tr");

    for (let i = 0; i < rows.length; i++) {
        let textContent = rows[i].textContent.toLowerCase();
        // Agar row mein search kiya hua shabd hai toh dikhao, varna chhupa do
        if (textContent.includes(input)) {
            rows[i].style.display = "";
        } else {
            rows[i].style.display = "none";
        }
    }
}
    </script>
</body>

</html>

